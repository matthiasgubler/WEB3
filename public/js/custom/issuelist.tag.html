<issuelist show="{ display }">
    <section id="issues">
        <fieldset>
            <legend class="rainbow3">Issues</legend>
            <section id="issueList">
                <ul>
                    <issue each="{ issue in allIssues() }" currentissue="{ issue }"></issue>
                </ul>
            </section>
        </fieldset>
    </section>
    <script>
        var tag = this;
        tag.display = false;
        tag.issues = new IssueCollection();
        tag.allIssues = function () {
            return tag.issues.getPrioritySorted();
        }

        this.bus.on('issueAdded', function (issue) {
            tag.issues.add(issue);
            tag.bus.trigger('updatedIssues', tag.issues);
            tag.update();
        });

        this.bus.on('issueRemoved', function (client_id) {
            tag.issues.remove(client_id);
            tag.bus.trigger('updatedIssues', tag.issues);
            tag.update();
        });

        this.bus.on('projectChange', function (project) {
            tag.display = project != null;
            if (tag.display) {
                tag.issues = new IssueCollection(project.issueCollection);
            }
            tag.update();
        })
        ;

        this.bus.on('toggleCheckbox', function (client_id, done) {
            tag.issues.getByIdentifier(client_id).done = done;
            tag.bus.trigger('updatedIssues', tag.issues);
            tag.update();
        });

    </script>
</issuelist>